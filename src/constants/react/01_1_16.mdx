---
title: "useSyncExternalStore"
description: "ì™¸ë¶€ ì €ì¥ì†Œë¥¼ êµ¬ë…í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” React Hook"
---

import { Alert, AlertTitle, AlertDescription } from "@/components/ui/alert"
import { Card, CardHeader, CardTitle, CardDescription, CardContent } from "@/components/ui/card"
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs"

<Card className="mb-6">
  <CardHeader>
    <CardTitle>useSyncExternalStoreë€?</CardTitle>
    <CardDescription>
      React ì™¸ë¶€ì˜ ë°ì´í„° ì €ì¥ì†Œë¥¼ êµ¬ë…í•˜ê³  í•´ë‹¹ ì €ì¥ì†Œì˜ ê°’ì„ ì½ì„ ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” Hookì…ë‹ˆë‹¤.
    </CardDescription>
  </CardHeader>
  <CardContent>
    ```tsx
    const snapshot = useSyncExternalStore(subscribe, getSnapshot, getServerSnapshot?)
    ```
  </CardContent>
</Card>

## API ë ˆí¼ëŸ°ìŠ¤

### ë§¤ê°œë³€ìˆ˜

<Card className="mb-4">
  <CardContent className="space-y-4">
    - **subscribe**: ì €ì¥ì†Œì˜ ë³€ê²½ì‚¬í•­ì„ êµ¬ë…í•˜ëŠ” í•¨ìˆ˜
      - ì½œë°± í•¨ìˆ˜ë¥¼ ì¸ìë¡œ ë°›ì•„ ì €ì¥ì†Œì— êµ¬ë…ì„ ì„¤ì •
      - êµ¬ë…ì„ ì •ë¦¬í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë°˜í™˜í•´ì•¼ í•¨
    
    - **getSnapshot**: ì €ì¥ì†Œì˜ í˜„ì¬ ë°ì´í„° ìŠ¤ëƒ…ìƒ·ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜
      - ì €ì¥ì†Œê°€ ë³€ê²½ë˜ì§€ ì•Šì•˜ë‹¤ë©´ ê°™ì€ ê°’ì„ ë°˜í™˜í•´ì•¼ í•¨
      - ë³€ê²½ë˜ì—ˆë‹¤ë©´ ë‹¤ë¥¸ ê°’ì„ ë°˜í™˜í•´ì•¼ í•¨
    
    - **getServerSnapshot?**: (ì„ íƒì ) ì„œë²„ ë Œë”ë§ì„ ìœ„í•œ ì´ˆê¸° ìŠ¤ëƒ…ìƒ·ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜
  </CardContent>
</Card>

## ê¸°ë³¸ ì‚¬ìš©ë²•

### ì™¸ë¶€ ì €ì¥ì†Œ êµ¬ë…í•˜ê¸°

<Tabs defaultValue="store" className="w-full">
  <TabsList>
    <TabsTrigger value="store">ê¸°ë³¸ ì˜ˆì œ</TabsTrigger>
    <TabsTrigger value="browser">ë¸Œë¼ìš°ì € API</TabsTrigger>
  </TabsList>
  
  <TabsContent value="store">
    ```tsx
    function TodosApp() {
      const todos = useSyncExternalStore(
        todosStore.subscribe,
        todosStore.getSnapshot
      );

      return (
        <ul>
          {todos.map(todo => (
            <li key={todo.id}>{todo.text}</li>
          ))}
        </ul>
      );
    }
    ```
  </TabsContent>
  
  <TabsContent value="browser">
    ```tsx
    function ChatIndicator() {
      const isOnline = useSyncExternalStore(
        subscribe,
        () => navigator.onLine,
        () => true // ì„œë²„ ì‚¬ì´ë“œ ì´ˆê¸°ê°’
      );

      return (
        <div>
          {isOnline ? 'âœ… ì˜¨ë¼ì¸' : 'âŒ ì˜¤í”„ë¼ì¸'}
        </div>
      );
    }

    function subscribe(callback) {
      window.addEventListener('online', callback);
      window.addEventListener('offline', callback);
      return () => {
        window.removeEventListener('online', callback);
        window.removeEventListener('offline', callback);
      };
    }
    ```
  </TabsContent>
</Tabs>

<Alert className="mt-6">
  <AlertTitle>ì‚¬ìš© ì‹œ ê³ ë ¤ì‚¬í•­</AlertTitle>
  <AlertDescription>
    1. ê°€ëŠ¥í•œ ê²½ìš° Reactì˜ ë‚´ì¥ ìƒíƒœ ê´€ë¦¬(useState, useReducer)ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.
    2. ì´ Hookì€ ì£¼ë¡œ ê¸°ì¡´ ë¹„ React ì½”ë“œì™€ì˜ í†µí•©ì— ìœ ìš©í•©ë‹ˆë‹¤.
    3. store ìŠ¤ëƒ…ìƒ·ì€ ë°˜ë“œì‹œ ë¶ˆë³€í•´ì•¼ í•©ë‹ˆë‹¤.
    4. subscribe í•¨ìˆ˜ëŠ” ê°€ëŠ¥í•œ ì»´í¬ë„ŒíŠ¸ ì™¸ë¶€ì— ì„ ì–¸í•˜ì„¸ìš”.
  </AlertDescription>
</Alert>

## ì»¤ìŠ¤í…€ Hookìœ¼ë¡œ ë¡œì§ ì¶”ì¶œ

<Card className="mb-6">
  <CardHeader>
    <CardTitle>ì¬ì‚¬ìš© ê°€ëŠ¥í•œ Hook ë§Œë“¤ê¸°</CardTitle>
  </CardHeader>
  <CardContent>
    ```tsx
    export function useOnlineStatus() {
      const isOnline = useSyncExternalStore(subscribe, getSnapshot);
      return isOnline;
      
      function getSnapshot() {
        return navigator.onLine;
      }
      
      function subscribe(callback) {
        window.addEventListener('online', callback);
        window.addEventListener('offline', callback);
        return () => {
          window.removeEventListener('online', callback);
          window.removeEventListener('offline', callback);
        };
      }
    }

    // ì‚¬ìš© ì˜ˆì‹œ
    function StatusBar() {
      const isOnline = useOnlineStatus();
      return <div>{isOnline ? 'ì˜¨ë¼ì¸' : 'ì˜¤í”„ë¼ì¸'}</div>;
    }
    ```
  </CardContent>
</Card>

## ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ ì§€ì›

<Tabs defaultValue="basic" className="w-full">
  <TabsList>
    <TabsTrigger value="basic">ê¸°ë³¸ êµ¬í˜„</TabsTrigger>
    <TabsTrigger value="advanced">ê³ ê¸‰ íŒ¨í„´</TabsTrigger>
  </TabsList>
  
  <TabsContent value="basic">
    ```tsx
    export function useOnlineStatus() {
      const isOnline = useSyncExternalStore(
        subscribe,
        getSnapshot,
        // ì„œë²„ ìŠ¤ëƒ…ìƒ· ì œê³µ
        () => true // ì„œë²„ì—ì„œëŠ” í•­ìƒ 'ì˜¨ë¼ì¸' í‘œì‹œ
      );
      return isOnline;
    }
    ```
  </TabsContent>
  
  <TabsContent value="advanced">
    ```tsx
    // ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ ê°„ ë°ì´í„° ë™ê¸°í™”
    function getServerSnapshot() {
      // 1. ì„œë²„ì—ì„œ HTML ìƒì„± ì‹œ
      // 2. í´ë¼ì´ì–¸íŠ¸ì—ì„œ í•˜ì´ë“œë ˆì´ì…˜ ì‹œ
      if (typeof window === 'undefined') {
        return initialData; // ì„œë²„ ë°ì´í„°
      }
      return window.MY_STORE_DATA; // í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ë‹¬ëœ ë°ì´í„°
    }
    ```
  </TabsContent>
</Tabs>

## ë¬¸ì œ í•´ê²°

### getSnapshot ê´€ë ¨ ì˜¤ë¥˜

<Alert className="mb-6" variant="destructive">
  <AlertTitle>"The result of getSnapshot should be cached" ì˜¤ë¥˜</AlertTitle>
  <AlertDescription>
    ```tsx
    // ğŸ”´ ì˜ëª»ëœ ë°©ë²•: ë§¤ë²ˆ ìƒˆë¡œìš´ ê°ì²´ ë°˜í™˜
    function getSnapshot() {
      return { todos: myStore.todos };
    }

    // âœ… ì˜¬ë°”ë¥¸ ë°©ë²•: ë¶ˆë³€ ë°ì´í„° ì§ì ‘ ë°˜í™˜
    function getSnapshot() {
      return myStore.todos;
    }

    // âœ… ë³€ê²½ ê°€ëŠ¥í•œ ë°ì´í„°ì˜ ê²½ìš°
    function getSnapshot() {
      if (hasChanged(myStore.todos)) {
        lastSnapshot = createSnapshot(myStore.todos);
      }
      return lastSnapshot;
    }
    ```
  </AlertDescription>
</Alert>

### êµ¬ë… í•¨ìˆ˜ ìµœì í™”

<Card className="mb-6">
  <CardContent>
    ```tsx
    // ğŸ”´ í”¼í•´ì•¼ í•  ë°©ë²•: ë§¤ ë Œë”ë§ë§ˆë‹¤ ìƒˆë¡œìš´ í•¨ìˆ˜
    function ChatIndicator() {
      const isOnline = useSyncExternalStore(
        () => { // ì¸ë¼ì¸ í•¨ìˆ˜
          // ...
        },
        getSnapshot
      );
    }

    // âœ… ê¶Œì¥í•˜ëŠ” ë°©ë²•: ì»´í¬ë„ŒíŠ¸ ì™¸ë¶€ë¡œ ì´ë™
    const subscribe = (callback) => {
      // ...
    };

    function ChatIndicator() {
      const isOnline = useSyncExternalStore(
        subscribe,
        getSnapshot
      );
    }

    // âœ… ë˜ëŠ” useCallback ì‚¬ìš©
    function ChatIndicator({ userId }) {
      const subscribe = useCallback((callback) => {
        // ...
      }, [userId]);
    }
    ```
  </CardContent>
</Card>

## ëª¨ë²” ì‚¬ë¡€

<Card className="mt-6">
  <CardContent className="space-y-4">
    1. **ë¶ˆë³€ì„± ìœ ì§€**:
       - ìŠ¤ëƒ…ìƒ·ì€ í•­ìƒ ë¶ˆë³€ì´ì–´ì•¼ í•¨
       - ë³€ê²½ ê°€ëŠ¥í•œ ë°ì´í„°ëŠ” ìŠ¤ëƒ…ìƒ·ìœ¼ë¡œ ë³€í™˜

    2. **ì„±ëŠ¥ ìµœì í™”**:
       - subscribe í•¨ìˆ˜ëŠ” ì»´í¬ë„ŒíŠ¸ ì™¸ë¶€ì— ì •ì˜
       - í•„ìš”í•œ ê²½ìš°ë§Œ useCallback ì‚¬ìš©
       
    3. **ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§**:
       - ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ ë°ì´í„° ì¼ì¹˜ ë³´ì¥
       - ì ì ˆí•œ ì´ˆê¸°ê°’ ì œê³µ
  </CardContent>
</Card>

<Alert className="mt-6">
  <AlertTitle>ì¶”ê°€ ê³ ë ¤ì‚¬í•­</AlertTitle>
  <AlertDescription>
    1. Transition ì—…ë°ì´íŠ¸ ì¤‘ ì €ì¥ì†Œê°€ ë³€ê²½ë˜ë©´ ë¸”ë¡œí‚¹ ì—…ë°ì´íŠ¸ë¡œ ì „í™˜ë©ë‹ˆë‹¤.
    2. Suspenseì™€ í•¨ê»˜ ì‚¬ìš©í•  ë•ŒëŠ” ì£¼ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤.
    3. ê°€ëŠ¥í•œ í•œ Reactì˜ ë‚´ì¥ ìƒíƒœ ê´€ë¦¬ë¥¼ ìš°ì„  ê³ ë ¤í•˜ì„¸ìš”.
  </AlertDescription>
</Alert>